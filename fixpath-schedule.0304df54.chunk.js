(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"8pQp":function(e,t,n){"use strict";n.r(t);var r=n("2/Rp"),o=n("bx4M"),a=n("kPKH"),i=n("+eQT"),l=n("Vl3Y"),u=n("kLXV"),c=n("BMrR"),s=n("W9HT"),p=n("ayp/"),f=n("Mpt7"),d=n("wd/R"),y=n.n(d),m=n("dZay"),h=n.n(m),b=n("q1tI"),v=n("peh1"),g=n("2fM7"),O=n("kl6h"),S=n("LvDl"),w=n("Qyje"),k=n.n(w),E=n("sy1d"),_=n("bG2F");function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=function(e,t){return Object(E.a)({method:"post",url:"/ehuodiGateway/utmsDispatch/utmsDrivercs/selectDriverListByCondition",data:k.a.stringify(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){D(e,t,n[t])})}return e}({},t,{searchInfo:e,pageSize:20,skipCount:0}))},{useMock:_.h}).then(function(e){return e.data})};function j(e){return(j="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function F(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t){return!t||"object"!==j(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var T=g.a.Option,R=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=I(this,(e=x(t)).call.apply(e,[this].concat(o)))).state={data:[],pending:!1},n.lastFetchId=0,n.fetch=Object(S.debounce)(function(e){var t=n.props.bindingStatus,r={};"number"===typeof t&&Object.assign(r,{bindingStatus:t}),n.lastFetchId+=1;var o=n.lastFetchId;n.setState({data:[],pending:!0}),C(e,r).then(function(e){o===n.lastFetchId&&n.setState({data:e,pending:!1})}).catch(function(){n.setState({pending:!1})})},500),n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(t,b["PureComponent"]),n=t,o=[{key:"renderOption",value:function(e){return b.createElement(T,{key:e.utmsUsersDriversId,value:e.utmsUsersDriversId},e.driverName,"-",e.plateNumber)}}],(r=[{key:"render",value:function(){var e=this.props,n=e.placeholder,r=e.notFoundContent,o=e.renderOption,a=F(e,["placeholder","notFoundContent","renderOption"]),i=this.state,l=i.data,u=i.pending,c={placeholder:n,showSearch:!0,onSearch:this.fetch,notFoundContent:u?b.createElement(s.a,null):r,filterOption:!1};return b.createElement(g.a,P({},a,c),l.map(o||t.renderOption))}}])&&N(n.prototype,r),o&&N(n,o),t}();R.defaultProps={placeholder:"\u8bf7\u9009\u62e9\u53f8\u673a",notFoundContent:"\u6ca1\u6709\u627e\u5230\u5339\u914d\u7684\u53f8\u673a",bindingStatus:null};var W=n("CtXQ"),Y=n("gnYR"),L=n.n(Y);function B(e){return(B="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q(e,t){return!t||"object"!==B(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Q,U=[{weekDay:1,displayName:"\u5468\u4e00"},{weekDay:2,displayName:"\u5468\u4e8c"},{weekDay:3,displayName:"\u5468\u4e09"},{weekDay:4,displayName:"\u5468\u56db"},{weekDay:5,displayName:"\u5468\u4e94"},{weekDay:6,displayName:"\u5468\u516d"},{weekDay:7,displayName:"\u5468\u65e5"}],z=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=q(this,(e=H(t)).call.apply(e,[this].concat(o)))).handleDeleteCard=function(e){var t=e.currentTarget.dataset,r=t.driverId,o=t.useCarTime,a=t.weekday,i=t.uuid;n.props.onDelete({driverId:r,usecartime:o,weekDay:a,uuid:i})},n.renderScheduleCard=function(e){var t=e.get("id")?e.get("id"):e.get("uuid");return b.createElement("div",{className:L.a.WeeklyEditor__Card,key:t},b.createElement(W.a,{"data-weekday":e.get("weekDay")||e.get("weekday"),"data-use-car-time":e.get("usecartime"),"data-driver-id":e.get("driverId"),"data-uuid":t,className:L.a.WeeklyEditor__CardClose,type:"close",onClick:n.handleDeleteCard}),b.createElement("p",null,e.get("usecartime")),b.createElement("p",null,e.get("driverName")),b.createElement("p",null,e.get("plateNumber")))},n.renderDayColumn=function(e){var t=n.props.data;return b.createElement("div",{className:L.a.WeeklyEditor__DayColumn,key:e.weekDay},b.createElement("h5",{className:L.a.WeeklyEditor__DayTitle},e.displayName),t.filter(function(t){return Number(t.get("weekDay"))===e.weekDay}).sortBy(function(e){return e.get("usecartime")}).map(n.renderScheduleCard).toArray())},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,b["PureComponent"]),n=t,(r=[{key:"render",value:function(){return b.createElement("div",{className:L.a.WeeklyEditor},U.map(this.renderDayColumn))}}])&&A(n.prototype,r),o&&A(n,o),t}();function X(e){return(X="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(){return(G=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e,t){return!t||"object"!==X(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ee,te=g.a.Option,ne=l.a.Item,re={labelCol:{span:6},wrapperCol:{span:16}},oe=U.map(function(e){return b.createElement(te,{key:e.weekDay,value:e.weekDay},e.displayName)}),ae=l.a.create()(Q=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=K(this,(e=Z(t)).call.apply(e,[this].concat(o)))).handleSubmit=function(){var e=n.props,t=e.form,r=e.onConfirm;t.validateFields(function(e,t){e||r(t)})},n.handleClose=function(){n.props.onClose()},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(t,b["PureComponent"]),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){e.visible&&!this.props.visible&&e.form.resetFields()}},{key:"renderEditor",value:function(){var e=this.props.form,t=e.getFieldDecorator;e.setFieldsValue;return b.createElement(l.a,null,b.createElement(ne,G({},re,{label:"\u9009\u62e9\u5468\u671f",required:!0}),t("weekdays",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5468\u671f"}]})(b.createElement(g.a,{mode:"multiple",showArrow:!0},oe))),b.createElement(ne,G({},re,{label:"\u7528\u8f66\u65f6\u95f4",required:!0}),t("usecartime",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7528\u8f66\u65f6\u95f4"}]})(b.createElement(O.a,{format:"HH:mm"}))),b.createElement(ne,G({},re,{label:"\u9009\u62e9\u53f8\u673a"}),t("driver")(b.createElement(R,{renderOption:function(e){var t=[e.utmsDriverId,e.driverName,e.plateNumber].join("@");return b.createElement(te,{key:e.utmsDriverId,value:t},e.driverName,"-",e.plateNumber)}}))))}},{key:"render",value:function(){var e={title:"\u6dfb\u52a0\u73ed\u6b21",visible:this.props.visible,maskClosable:!1,centered:!0,onOk:this.handleSubmit,onCancel:this.handleClose};return b.createElement(u.a,e,this.renderEditor())}}])&&J(n.prototype,r),o&&J(n,o),t}())||Q;function ie(e){return(ie="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ue(e,t){return!t||"object"!==ie(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function se(e,t){return(se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pe=l.a.Item,fe=i.a.RangePicker,de=u.a.confirm,ye=l.a.create()(ee=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=ue(this,(e=ce(t)).call.apply(e,[this].concat(o)))).state={openModal:!1},n.handleClose=function(){de({title:"\u6709\u672a\u4fdd\u5b58\u7684\u4fe1\u606f",content:"\u5982\u653e\u5f03\uff0c\u586b\u5199\u7684\u4fe1\u606f\u5c06\u4e22\u5931",okText:"\u7ee7\u7eed\u586b\u5199",cancelText:"\u653e\u5f03",onCancel:function(){n.props.toList(),n.props.close(),h()("/fixpath/list","refresh").emit(!0)}})},n.handleOpenModal=function(){n.setState({openModal:!0})},n.handleCloseModal=function(){n.setState({openModal:!1})},n.handleCreateSchedule=function(e){n.props.createSchedule(e),n.setState({openModal:!1})},n.handleSubmitSchedule=function(){var e=n.props,t=e.form,r=e.saveScheduleConfig;t.validateFields(function(e,t){e||r(t.dateRange,n.props.close)})},n}var n,i,d;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&se(e,t)}(t,b["PureComponent"]),n=t,(i=[{key:"componentDidMount",value:function(){var e=this.props,t=e.close,n=e.searchParams;n.routeId?(this.props.getSchedule(n.routeId),this.props.getDetail(n.routeId)):u.a.error({title:"\u53c2\u6570\u5f02\u5e38",content:"\u7f3a\u5c11\u7ebf\u8defID\uff0c\u9875\u9762\u5c06\u5173\u95ed",onOk:function(){t()}})}},{key:"componentWillReceiveProps",value:function(e){e.scheduleData&&e.scheduleData!==this.props.scheduleData&&this.setRangeDate(e)}},{key:"renderInfo",value:function(){var e=this.props,t=e.form,n=(e.scheduleData,e.detail),i=t.getFieldDecorator;t.setFieldsValue;return b.createElement(l.a,{layout:"inline"},b.createElement(o.a,{title:"\u8fd0\u529b\u8ba1\u5212",className:L.a.FixpathSchedule__InfoCard},b.createElement(c.a,{className:L.a.FixpathSchedule__FormItem},b.createElement(a.a,{md:12,lg:8},b.createElement(pe,{label:"\u5ba2\u6237\u540d\u79f0"},n.get("customerName"))),b.createElement(a.a,{md:12,lg:8},b.createElement(pe,{label:"\u7ebf\u8def\u540d\u79f0"},n.get("routeName"))))),b.createElement(o.a,null,b.createElement(c.a,{className:L.a.FixpathSchedule__FormItem},b.createElement(a.a,{md:24,lg:24},b.createElement(pe,{required:!0,label:"\u8d77\u6b62\u65f6\u95f4"},i("dateRange",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8d77\u6b62\u65f6\u95f4"}]})(b.createElement(fe,null))))),b.createElement(c.a,null,b.createElement(a.a,null,b.createElement(r.a,{type:"dashed",icon:"plus",block:!0,onClick:this.handleOpenModal},"\u6dfb\u52a0\u73ed\u6b21"))),this.renderWeekEditor()))}},{key:"renderWeekEditor",value:function(){var e=this.props,t=e.scheduleData,n=e.deleteSchedule;return b.createElement(z,{data:t.get("workScheduleDetailList",Object(f.List)()),onDelete:n})}},{key:"renderBottom",value:function(){var e=this.props.scheduleData,t=[b.createElement(r.a,{key:"cancle",className:L.a.FixpathSchedule__BottomActionButton,onClick:this.handleClose},"\u53d6\u6d88"),b.createElement(r.a,{key:"save",type:"primary",disabled:0===e.get("workScheduleDetailList",Object(f.List)()).count(),onClick:this.handleSubmitSchedule},"\u4fdd\u5b58\u7ebf\u8def")];return b.createElement(p.a,{rightChild:t})}},{key:"render",value:function(){return b.createElement(b.Fragment,null,b.createElement(s.a,{spinning:this.props.loading},b.createElement("div",{className:L.a.FixpathSchedule},this.renderInfo(),this.renderBottom())),b.createElement(ae,{visible:this.state.openModal,onConfirm:this.handleCreateSchedule,onClose:this.handleCloseModal}))}},{key:"setRangeDate",value:function(e){var t=e.scheduleData,n=e.form;t.size&&t.get("startDate")&&t.get("endDate")&&!n.getFieldValue("dateRange")&&n.setFieldsValue({dateRange:[y()(t.get("startDate"),"YYYY-MM-DD"),y()(t.get("endDate"),"YYYY-MM-DD")]})}}])&&le(n.prototype,i),d&&le(n,d),t}())||ee;t.default=function(e){var t=e.routeId;return(0,e.connectModel)(function(e){var n,r=function(e){return e.get(t)};return{mapStateToProps:Object(v.createStructuredSelector)({detail:(n=r,Object(v.createSelector)(n,function(e){return e.get("detail")})),scheduleData:function(e){return Object(v.createSelector)(e,function(e){return e.get("data")})}(r),error:function(e){return Object(v.createSelector)(e,function(e){return e.get("error")})}(r),loading:function(e){return Object(v.createSelector)(e,function(e){return e.get("loading")})}(r)}),mapDispatchToProps:function(t){return{getSchedule:function(n){return t(e.getSchedule(n))},getDetail:function(n){return t(e.getDetail(n))},createSchedule:function(n){return t(e.createSchedule(n))},deleteSchedule:function(n){return t(e.deleteSchedule(n))},saveScheduleConfig:function(n,r){return t(e.saveScheduleConfig(n,r))},toList:function(n){return t(e.toList(n))}}}}})(ye)}},gnYR:function(e,t,n){e.exports={FixpathSchedule:"_1pHbi",FixpathSchedule__BottomActionButton:"_3Yp3U",FixpathSchedule__InfoCard:"ob21b",FixpathSchedule__FormItem:"_ECHF",WeeklyEditor:"_1cHxI",WeeklyEditor__DayColumn:"UaX_P",WeeklyEditor__DayTitle:"_1Ex1a",WeeklyEditor__Card:"_1TzbP",WeeklyEditor__CardClose:"rWE0m"}}}]);
//# sourceMappingURL=fixpath-schedule.0304df54.chunk.js.map