(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{GPbw:function(t,e,n){t.exports={AddressMap:"KRS7x",AddressMap__Checkbox:"_16ijZ",AddressMap__Box:"_1N5i0"}},W1On:function(t,e,n){t.exports={divInfoWindow:"_21z2S",divf:"_30HoS",curr:"_10p9C"}},ibCj:function(t,e,n){"use strict";n.r(e);var o=n("Mpt7"),r=n("q1tI"),a=n("peh1"),i=n("2/Rp"),u=n("bx4M"),c=n("Vl3Y"),s=n("ocjk"),l=n("5rEg"),p=n("NJEC"),f=n("2fM7"),d=n("W9HT"),h=n("ZTPi"),y=n("EIz2"),m=n("f/1f"),v=n("1f+Y"),g=n("kaz8"),b=n("Gytx"),w=n.n(b);function S(t){return(S="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function C(t,e){return!e||"object"!==S(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var D=function(t){function e(t){var n,o=t.data,r=t.onClick,a=t.onShowInfo,i=t.onHideInfo;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=C(this,O(e).call(this))).data=void 0,n.data=o,n.point=new BMap.Point(o.longitude,o.latitude),n.onClick=r,n.onShowInfo=a,n.onHideInfo=i,n}var n,o,r;return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(e,BMap.Overlay),n=e,(o=[{key:"initialize",value:function(t){var e=this;this.map=t;var n=document.createElement("div");return n.style.position="absolute",n.style.width="22px",n.style.height="30px",n.style.cursor="pointer",n.style.zIndex="1","\u4ed3\u5e93"===this.data.depotType?n.innerHTML="<img src='http://image.tf56.com/dfs/group1/M00/6C/D8/CiFBClvWvK2AavVpAAAFmv6mZVg018.png' width='22' height='30'>":"\u7f51\u70b9/\u95e8\u5e97"===this.data.depotType&&(n.innerHTML="<img src='http://image.tf56.com/dfs/group1/M00/6C/D5/CiFBCVvWvKyACWhzAAAFg7bh-nQ272.png' width='22' height='30'>"),n.onclick=function(t){e.onClick&&e.onClick(e)},n.onmouseenter=function(){e.onShowInfo&&e.onShowInfo(e.data)},n.onmouseout=function(){e.onHideInfo&&e.onHideInfo(e.data)},this.map.getPanes().labelPane.appendChild(n),this.div=n,n}},{key:"draw",value:function(){var t=this.map.pointToOverlayPixel(this.point);this.div.style.left=t.x-11+"px",this.div.style.top=t.y-15+"px"}},{key:"destroy",value:function(){this.div.onclick=null,this.data=null,this.point=null,this.onClick=null,this.onShowInfo=null,this.onHideInfo=null,this.map=null}}])&&k(n.prototype,o),r&&k(n,r),e}(),j=n("W1On"),P=n.n(j);function _(t){return(_="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function x(t,e){return!e||"object"!==_(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function T(t,e,n){return(T="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=I(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t,e){return(A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var W=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=x(this,I(e).call(this))).width=280,t.height=114,t}var n,o,r;return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(e,BMap.Overlay),n=e,(o=[{key:"initialize",value:function(t){return this.map=t,this.div=document.createElement("div"),this.div.style.width="".concat(this.width,"px"),this.div.style.height="".concat(this.height,"px"),this.div.className=P.a.divInfoWindow,this.divCurrow=document.createElement("div"),this.divCurrow.className=P.a.curr,this.div.appendChild(this.divCurrow),this.content=document.createElement("div"),this.content.className=P.a.divf,this.div.appendChild(this.content),this.map.getPanes().labelPane.appendChild(this.div),this.div}},{key:"draw",value:function(){var t=this.map.pointToOverlayPixel(this.point),e=t.x-this.width/2,n=t.y-this.height-31,o=this.width/2-11,r=this.height-5,a=this.div.parentElement.parentElement.parentElement;if(a){var i=this.map.getContainer(),u=i.offsetWidth,c=(i.offsetHeight,e+a.offsetLeft),s=n+a.offsetTop;c<0?(e=t.x-this.width/2-c,o=o+c+0):c+this.width>u&&(e=t.x-this.width/2-(this.width+c-u)-0,o=o+(this.width+c-u)+3+1),s-90<0?(n=t.y+26,r=-10,this.divCurrow.style.transform="rotate(45deg)"):(r-=7,this.divCurrow.style.transform="rotate(-45deg)")}this.div.style.left=e+"px",this.div.style.top=n+"px",this.divCurrow.style.left=o+"px",this.divCurrow.style.top=r+"px"}},{key:"setSize",value:function(){this.div.style.width=this.width+"px",this.div.style.height=this.height+"px"}},{key:"show",value:function(){T(I(e.prototype),"show",this).call(this),this.draw()}},{key:"setPosition",value:function(t){this.point=t}},{key:"showValue",value:function(t){return null===t||void 0===t||""===t?"":t}},{key:"setData",value:function(t){this.content.innerHTML="<table><tr><th>\u540d\u79f0\uff1a</th><td>"+this.showValue(t.depotName)+"</td></tr><tr><th>\u7c7b\u578b\uff1a</th><td>"+this.showValue(t.depotType)+"</td></tr><tr><th>\u8054\u7cfb\u4eba\uff1a</th><td>"+this.showValue(t.createOperatorName)+"</td></tr><tr><th>\u8054\u7cfb\u7535\u8bdd\uff1a</th><td>"+this.showValue(t.contactWay)+"</td></tr></table>"}}])&&M(n.prototype,o),r&&M(n,r),e}(),H=(n("TXFw"),n("cm23")),N=n("GPbw"),z=n.n(N);function B(t){return(B="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function F(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function V(t,e){return!e||"object"!==B(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function R(t){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Z=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=V(this,R(e).call(this,t))).state=void 0,n.divMap=void 0,n.map=void 0,n.infoWindow=void 0,n.removeMapElement=function(t){t&&t.parentElement.removeChild(t)},n.onShowInfo=function(t){n.infoWindow?n.infoWindow.setPosition(new BMap.Point(t.longitude,t.latitude)):(n.infoWindow=new W,n.infoWindow.setPosition(new BMap.Point(t.longitude,t.latitude)),n.map.addOverlay(n.infoWindow)),n.infoWindow.setData(t),n.infoWindow.show()},n.onHideInfo=function(){n.infoWindow.hide()},n.handleChange=function(t){n.setState({checkedList:t}),n.state.depot.map(function(t){t.hide()}),n.state.store.map(function(t){t.hide()}),t.map(function(t){"\u4ed3\u5e93"===t&&n.state.depot.map(function(t){t.show()}),"\u7f51\u70b9/\u95e8\u5e97"===t&&n.state.store.map(function(t){t.show()})})},n.state={data:[]||t.data,checkedList:["\u4ed3\u5e93","\u7f51\u70b9/\u95e8\u5e97"],depot:[],store:[],loading:!1},n}var n,o,a;return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(e,r["PureComponent"]),n=e,(o=[{key:"componentDidMount",value:function(){this.initMap()}},{key:"componentWillReceiveProps",value:function(t){var e=this;w()(this.state.data,t.data)||this.setState({data:t.data||{}},function(){e.initMarkes()})}},{key:"initMarkes",value:function(){var t=this;if(this.setState({loading:!0}),0!==this.state.data.length){var e=[],n=[],o=[];this.state.data.forEach(function(r,a){var i=new D({data:r,onClick:t.onShowInfo,onShowInfo:t.onShowInfo,onHideInfo:t.onHideInfo});"\u4ed3\u5e93"===r.depotType?e.push(i):"\u7f51\u70b9/\u95e8\u5e97"===r.depotType&&n.push(i),t.map.addOverlay(i);var u=new BMap.Point(r.longitude,r.latitude);o.push(u),a===t.state.data.length-1&&t.setState({loading:!1})}),this.setState({depot:e,store:n}),Object(H.setTimeout)(function(){t.map.setViewport(o)},100)}}},{key:"initMap",value:function(){var t=this;this.map=new BMap.Map(this.divMap,{minZoom:1,maxZoom:19,enableMapClick:!1}),this.map.enableScrollWheelZoom(!0),this.map.addEventListener("tilesloaded",function(){t.removeMapElement(document.querySelector(".anchorBL")),t.removeMapElement(document.querySelector(".BMap_cpyCtrl"))}),this.map.centerAndZoom("\u676d\u5dde",12)}},{key:"render",value:function(){var t=this;return r.createElement("div",{className:z.a.AddressMap},r.createElement("div",{className:z.a.AddressMap__Checkbox},r.createElement(g.a.Group,{value:this.state.checkedList,onChange:this.handleChange},r.createElement(g.a,{value:"\u4ed3\u5e93"},"\u4ed3\u5e93"),r.createElement(g.a,{value:"\u7f51\u70b9/\u95e8\u5e97"},"\u7f51\u70b9"))),r.createElement(d.a,{spinning:this.state.loading},r.createElement("div",{className:z.a.AddressMap__Box,ref:function(e){return t.divMap=e}})))}}])&&F(n.prototype,o),a&&F(n,a),e}();function K(t){return(K="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function G(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(e){q(t,e,n[e])})}return t}function q(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Y(t,e){return!e||"object"!==K(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Q(t){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function X(t,e){return(X=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var U=f.a.Option,$=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return(n=Y(this,(t=Q(e)).call.apply(t,[this].concat(a)))).state={skipCount:0,pageSize:15,current:1,activeKey:"1"},n.renderMap=function(){var t=n.props.mapData,e=t?t.map(function(t){return{key:t.get("utmsDepotId"),depotName:t.get("depotName"),depotType:t.get("depotType"),province:t.get("province"),city:t.get("city"),region:t.get("region"),address:t.get("address"),contact:t.get("contact"),contactWay:t.get("contactWay"),longitude:t.get("longitude"),latitude:t.get("latitude"),isDefault:t.get("isDefault")}}).toArray():[];return r.createElement(Z,{data:e})},n.handleTabsChange=function(t){var e=n.props.getMapData;"2"===t&&("1"===n.state.activeKey&&e({coordinateType:"BD09",pageSize:1e6,skipCount:0}),n.setState({activeKey:t}))},n.onSearchHandle=function(){n.setState({skipCount:0,current:1}),n.fetchDataFun()},n.handleReset=function(){n.props.form.resetFields(),n.onSearchHandle()},n.paginationChange=function(t){var e=t.skipCount,o=t.pageSize,r=t.current;n.setState({skipCount:e,pageSize:o,current:r}),n.fetchDataFun({skipCount:e,pageSize:o})},n.setDefaultHanlde=function(t){var e=n.state,o=e.pageSize,r=e.skipCount,a=n.props.form.getFieldsValue();n.props.setDefault(G({utmsDepotId:t,skipCount:r,pageSize:o},a))},n.delAddressHandle=function(t){var e=n.state,o=e.pageSize,r=e.skipCount,a=n.props.form.getFieldsValue();n.props.delAddressData(G({utmsDepotId:t,skipCount:r,pageSize:o},a))},n}var n,o,a;return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&X(t,e)}(e,r["PureComponent"]),n=e,(o=[{key:"componentDidMount",value:function(){this.fetchDataFun()}},{key:"render",value:function(){var t=r.createElement("div",{className:"btn"},r.createElement(i.a,{type:"primary",onClick:this.props.addAddressData},"\u65b0\u589e\u5730\u5740"));return r.createElement(d.a,{spinning:this.props.loading},r.createElement(u.a,null,r.createElement(h.a,{tabBarExtraContent:t,onChange:this.handleTabsChange},r.createElement(h.a.TabPane,{tab:"\u5ba2\u6237\u5730\u5740\u5217\u8868",key:"1",style:{height:"100%"}},this.getFields(),this.getTable()),r.createElement(h.a.TabPane,{tab:"\u5730\u56fe\u6a21\u5f0f",key:"2",style:{height:"100%"}},this.renderMap()))))}},{key:"getTable",value:function(){var t=this,e=[{key:"mark",render:function(t){return 1===t.isDefault?r.createElement("div",{style:{whiteSpace:"nowrap"}},"\u9ed8\u8ba4\u4ed3\u5e93"):null}},{title:"\u5ba2\u6237\u540d\u79f0",dataIndex:"customerName",key:"customerName"},{title:"\u5730\u5740\u540d\u79f0",dataIndex:"depotName",key:"depotName"},{title:"\u7c7b\u578b",dataIndex:"depotType",key:"depotType"},{title:"\u7701\u5e02\u533a",key:"province",render:function(t){return"".concat(t.province).concat(t.city).concat(t.region)}},{title:"\u8be6\u7ec6\u5730\u5740",dataIndex:"address"},{title:"\u64cd\u4f5c",key:"action",width:105,render:function(e,n){return r.createElement("span",null,r.createElement(m.a,null,r.createElement("a",{href:"javascript:;",onClick:function(){return t.props.editAddressData(n.utmsDepotId)}},"\u7f16\u8f91"),r.createElement(p.a,{title:"\u662f\u5426\u786e\u8ba4\u5220\u9664\uff1f",onConfirm:function(){t.delAddressHandle(n.utmsDepotId)}},r.createElement("a",{href:"javascript:;"},"\u5220\u9664")),1===n.isDefault?null:r.createElement("a",{href:"javascript:;",onClick:function(){t.setDefaultHanlde(n.utmsDepotId)}},"\u8bbe\u4e3a\u9ed8\u8ba4\u4ed3\u5e93")))}}],n=this.props,o=n.data,a=n.dataCount,i={current:this.state.current,total:a,onChange:this.paginationChange,onShowSizeChange:this.paginationChange},u=o?o.map(function(t){return{key:t.get("utmsDepotId"),utmsDepotId:t.get("utmsDepotId"),customerName:t.get("customerName")||"--",depotName:t.get("depotName"),depotType:t.get("depotType"),province:t.get("province"),city:t.get("city"),region:t.get("region"),address:t.get("address"),contact:t.get("contact"),contactWay:t.get("contactWay"),longitude:t.get("longitude"),latitude:t.get("latitude"),isDefault:t.get("isDefault")}}).toArray():[];return r.createElement(y.a,{columns:e,dataSource:u,pagination:i})}},{key:"getFields",value:function(){var t=this,e=this.props.form.getFieldDecorator;return r.createElement(c.a,{layout:"inline",style:{marginBottom:"20px"}},r.createElement(s.a,{label:"\u5ba2\u6237\u540d\u79f0"},e("customerCode",{initialValue:""})(r.createElement(v.a,{style:{minWidth:100},showDefaultValue:!1}))),r.createElement(s.a,{label:"\u7c7b\u578b"},e("depotType",{initialValue:""})(r.createElement(f.a,{style:{width:"90px"}},r.createElement(U,{value:""},"\u5168\u90e8"),r.createElement(U,{value:"store"},"\u4ed3\u5e93"),r.createElement(U,{value:"site"},"\u7f51\u70b9/\u95e8\u5e97")))),r.createElement(s.a,null,e("keyword")(r.createElement(l.a,{placeholder:"\u5730\u5740\u540d\u79f0"}))),r.createElement(s.a,null,r.createElement(i.a,{type:"primary",htmlType:"submit",onClick:function(){t.onSearchHandle()}},"\u67e5\u8be2")),r.createElement(s.a,null,r.createElement(i.a,{onClick:this.handleReset},"\u91cd\u7f6e")))}},{key:"fetchDataFun",value:function(t){var e=this.props.form.getFieldsValue(),n=this.state.pageSize;this.props.getAsyncData(G({pageSize:n,skipCount:0},e,t))}}])&&J(n.prototype,o),a&&J(n,a),e}(),tt=c.a.create()($);e.default=function(t){var e=t.routeId;return(0,t.connectModel)(function(t){var n,r=function(t){return t.get(e,Object(o.Map)())};return{mapStateToProps:Object(a.createStructuredSelector)({data:(n=r,Object(a.createSelector)(n,function(t){return t.get("data")})),dataCount:function(t){return Object(a.createSelector)(t,function(t){return t.get("dataCount")})}(r),error:function(t){return Object(a.createSelector)(t,function(t){return t.get("error")})}(r),loading:function(t){return Object(a.createSelector)(t,function(t){return t.get("loading")})}(r),mapData:function(t){return Object(a.createSelector)(t,function(t){return t.get("mapData")})}(r)}),mapDispatchToProps:function(e){return{getAsyncData:function(n){return e(t.getAsyncData(n))},delAddressData:function(n){return e(t.delAddressData(n))},addAddressData:function(){return e(t.addAddressData())},editAddressData:function(n){return e(t.editAddressData(n))},setDefault:function(n){return e(t.setDefault(n))},getMapData:function(n){return e(t.getMapData(n))}}}}})(tt)}}}]);
//# sourceMappingURL=address-manage.d06dd0ad.chunk.js.map