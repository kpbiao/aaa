(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{"65fg":function(e,t,r){"use strict";r.r(t);var n=r("2/Rp"),o=r("bx4M"),a=r("kPKH"),c=r("PArb"),u=r("CtXQ"),s=r("5rEg"),i=r("NJEC"),l=r("BMrR"),m=r("EIz2"),d=r("q1tI"),f=r("/MKj"),p=r("2iEm"),y=r("ANjH"),h=r("peh1"),C=r("lMyb"),g=r("xR9c"),E=r.n(g);function b(e){return(b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t){return!t||"object"!==b(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}s.a.Search;var I=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=v(this,w(t).call(this,e))).state=void 0,r.keywordInput=void 0,r.getIspermission=function(e){var t=r.props.permissions,n=!1;try{t.map(function(t){e===t.get("operateKey")&&(n=!0)}).toArray()}catch(e){}return n},r.emitEmpty=function(){r.keywordInput.focus(),r.setState({keyword:""})},r.hanldCustomerAddSuccess=function(e){r.hanldModelCancel(),e.utmsCustomerId?(r.setState({currentItem:e}),r.props.editCustomer(e)):r.fetchCustomersData()},r.hanldModelCancel=function(){r.setState({customerAddVisible:!1})},r.showModal=function(e){r.setState({customerAddVisible:!0,currentItem:e})},r.hideModal=function(e){r.setState({customerAddVisible:!1})},r.fetchCustomersData=function(e){r.props.getCustomers(e),r.setState({current:(e?e.current:1)||1})},r.state={customerAddVisible:!1,keyword:"",current:1},r}var r,f,y;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,d["PureComponent"]),r=t,(f=[{key:"componentDidMount",value:function(){this.fetchCustomersData()}},{key:"render",value:function(){var e=this,t=this.props,r=t.customers,a=void 0===r?{}:r,c=(t.customersTotal,t.loading),u=this.state.current,s=this.getColumns(),i={total:a.count,onChange:this.fetchCustomersData,onShowSizeChange:this.fetchCustomersData,current:u};return d.createElement("div",null,d.createElement(o.a,{title:"\u5ba2\u6237\u5217\u8868",bordered:!0,extra:e.getIspermission("/customer/add")?d.createElement(n.a,{type:"primary"},d.createElement(p.a,{to:"/customer/add"},"\u65b0\u5efa\u5ba2\u6237")):""},this.renderSearchForm(),d.createElement(m.a,{columns:s,dataSource:a.data,pagination:i,rowKey:"utmsCustomerId",loading:c})))}},{key:"renderSearchForm",value:function(){var e=this,t=this.state.keyword,r=t?d.createElement(u.a,{type:"close-circle",onClick:this.emitEmpty}):null;return d.createElement("div",{style:{marginBottom:15}},d.createElement(s.a,{placeholder:"\u5ba2\u6237\u540d\u79f0/\u8054\u7cfb\u65b9\u5f0f",style:{width:250,marginRight:15},suffix:r,value:t||"",onPressEnter:function(t){e.fetchCustomersData({skipCount:0,keyword:e.state.keyword})},onChange:function(t){e.setState({keyword:t.target.value})},ref:function(t){return e.keywordInput=t}}),d.createElement(n.a,{type:"primary",style:{marginRight:12},onClick:function(){e.fetchCustomersData({skipCount:0,keyword:e.state.keyword})}},"\u67e5\u8be2"),d.createElement(n.a,{onClick:function(){e.setState({keyword:""}),e.fetchCustomersData({skipCount:0,keyword:""})}},"\u91cd\u7f6e"))}},{key:"renderTotalInfo",value:function(){var e=this.props.customersTotal,t=void 0===e?{}:e,r={xs:6,sm:6,lg:6,xl:6,className:E.a.totalInfoCard};return d.createElement(o.a,{className:E.a.totalCard},d.createElement(l.a,{gutter:10},d.createElement(a.a,r,d.createElement("h3",null,"\u603b\u5ba2\u6237"),d.createElement("p",null,t.totalCnt||C.a.emptyRecord)),d.createElement(a.a,r,d.createElement("h3",null,"\u7d2f\u8ba1\u53d1\u8d27\u5ba2\u6237"),d.createElement("p",null,t.releaseCnt||C.a.emptyRecord)),d.createElement(a.a,r,d.createElement("h3",null,"\u5ba2\u6237\u603b\u8ba2\u5355"),d.createElement("p",null,t.tradeCnt||C.a.emptyRecord)),d.createElement(a.a,r,d.createElement("h3",null,"\u5ba2\u6237\u603b\u8425\u6536\uff08\u4e07\uff09"),d.createElement("p",null,t.revenue||C.a.emptyRecord))))}},{key:"getColumns",value:function(){var e=this,t=this.props.deleteCustomer;return[{title:"\u5ba2\u6237\u540d\u79f0",dataIndex:"customerName",key:"customerName"},{title:"\u8054\u7cfb\u4eba",dataIndex:"contact",key:"contact",render:function(e,t){return d.createElement("span",{className:"my-nowrap"},e||C.a.emptyRecord)}},{title:"\u8054\u7cfb\u65b9\u5f0f",dataIndex:"contactWay",key:"contactWay",render:function(e,t){return d.createElement("span",{className:"my-nowrap"},e||C.a.emptyRecord)}},{title:"\u516c\u53f8\u5730\u5740",key:"organizationName",render:function(e,t){var r=C.a.emptyRecord;return t.address&&(r="".concat(t.province||""," ").concat(t.city||""," ").concat(t.region||""," ").concat(t.address)),r}},{title:"\u9500\u552e\u7ecf\u7406",key:"salesman",render:function(e,t){var r=e.salesman||[];return r.length?r.map(function(e,t){var n=t===r.length-1?"":"\u3001";return d.createElement("span",{key:e.jobcard,className:"my-nowrap"},e.name,n)}):C.a.emptyRecord}},{title:"\u64cd\u4f5c",key:"action",render:function(r,n){return d.createElement("span",{className:"my-nowrap"},function(t){return e.getIspermission("/customer/edit")?d.createElement(p.a,{to:"/customer/edit?id=".concat(t.utmsCustomerId)},"\u4fee\u6539"):d.createElement("span",null)}(n),function(){if(e.getIspermission("deleteCustomer"))return d.createElement(c.a,{type:"vertical"})}(),function(r){return e.getIspermission("deleteCustomer")?d.createElement(i.a,{title:"\u786e\u8ba4\u5220\u9664",onConfirm:function(){return t(r.utmsCustomerId)}},d.createElement("a",{href:"javascript:;"},"\u5220\u9664")):d.createElement("span",null)}(n))}}]}}])&&k(r.prototype,f),y&&k(r,y),t}();t.default=function(e){var t=e.routeId,r=e.actions,n=function(e){return e.get(t)},o=Object(h.createStructuredSelector)({error:function(e){return Object(h.createSelector)(e,function(e){return e.get("error")})}(n),loading:function(e){return Object(h.createSelector)(e,function(e){return e.get("loading")})}(n),customers:function(e){return Object(h.createSelector)(e,function(e){return e.get("customers")})}(n),customersTotal:function(e){return Object(h.createSelector)(e,function(e){return e.get("customersTotal")})}(n)}),a=Object(f.connect)(o,function(e){return{getCustomers:function(t){return e(r.getCustomers(t))},deleteCustomer:function(t){return e(r.deleteCustomer(t))},getCustomersTotal:function(t){return e(r.getCustomersTotal(t))},editCustomer:function(t){return e(r.editCustomer(t))}}});return Object(y.c)(a)(I)}},xR9c:function(e,t,r){e.exports={totalCard:"_39me9","ant-card-body":"_13DoM",totalInfoCard:"_20_Io"}}}]);
//# sourceMappingURL=customer.74e63c5f.chunk.js.map