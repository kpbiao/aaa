{"version":3,"sources":["webpack:///./src/components/DriverPicker/service.ts","webpack:///./src/components/DriverPicker/DriverPicker.tsx","webpack:///./src/modules/module.fixpath.schedule/WeeklyEditor.tsx","webpack:///./src/modules/module.fixpath.schedule/CreateScheduleModal.tsx","webpack:///./src/modules/module.fixpath.schedule/index.tsx","webpack:///./src/modules/module.fixpath.schedule/selectors.ts","webpack:///./src/modules/module.fixpath.schedule/index.module.less"],"names":["service","keyword","options","Object","request","method","url","data","qs_libfrom_dll_reference_dll_default","a","stringify","_objectSpread","searchInfo","pageSize","skipCount","useMock","CONFIG","then","res","Option","es_select","DriverPicker_DriverPicker","state","pending","lastFetchId","fetch","lodashfrom_dll_reference_dll","bindingStatus","_this","props","fetchOptions","assign","fetchId","setState","catch","react","item","key","utmsUsersDriversId","value","driverName","plateNumber","_this$props","this","placeholder","notFoundContent","renderOption","otherProps","_objectWithoutProperties","_this$state","showSearch","onSearch","spin","filterOption","_extends","map","DriverPicker","defaultProps","WEEKDAYS","weekDay","displayName","WeeklyEditor_WeeklyEditor","handleDeleteCard","e","_e$currentTarget$data","currentTarget","dataset","driverId","useCarTime","weekday","uuid","onDelete","usecartime","renderScheduleCard","detail","get","className","index_module_default","WeeklyEditor__Card","icon","data-weekday","data-use-car-time","data-driver-id","data-uuid","WeeklyEditor__CardClose","type","onClick","renderDayColumn","day","WeeklyEditor__DayColumn","WeeklyEditor__DayTitle","filter","d","Number","sortBy","toArray","WeeklyEditor","CreateScheduleModal_Option","FormItem","es_form","Item","itemLayout","labelCol","span","wrapperCol","WeekdaySelectOptions","CreateScheduleModal_CreateScheduleModal","create","handleSubmit","form","onConfirm","validateFields","errors","values","handleClose","onClose","nextProps","visible","resetFields","getFieldDecorator","setFieldsValue","CreateScheduleModal_extends","label","required","rules","message","mode","showArrow","time_picker","format","utmsDriverId","join","modalProps","title","maskClosable","centered","onOk","onCancel","modal","renderEditor","module_fixpath_schedule_FormItem","RangePicker","date_picker","module_fixpath_schedule_confirm","confirm","module_fixpath_schedule_FixpathSchedule","openModal","content","okText","cancelText","toList","close","msngrfrom_dll_reference_dll_default","emit","handleOpenModal","handleCloseModal","handleCreateSchedule","createSchedule","handleSubmitSchedule","saveScheduleConfig","dateRange","_this$props2","searchParams","routeId","getSchedule","getDetail","error","scheduleData","setRangeDate","_this$props3","layout","card","FixpathSchedule__InfoCard","row","FixpathSchedule__FormItem","col","md","lg","es_button","block","renderWeekEditor","_this$props4","deleteSchedule","immutable_esfrom_dll_reference_dll","actions","FixpathSchedule__BottomActionButton","disabled","count","PageBottom","rightChild","spinning","loading","FixpathSchedule","renderInfo","renderBottom","size","getFieldValue","momentfrom_dll_reference_dll_default","__webpack_exports__","_ref","connectModel","selectState","currentState","mapStateToProps","libfrom_dll_reference_dll","selectors_makeSelectData","selectors_makeSelectError","selectors_makeSelectLoading","mapDispatchToProps","dispatch","schedule","scehduleData","module","exports"],"mappings":"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","file":"fixpath-schedule.0304df54.chunk.js","sourcesContent":["/**\n * DriverPicker Service\n * @author ryan bian\n * @date 2018-9-17 16:32:18\n */\nimport qs from 'qs';\nimport request, { mocker } from 'utils/request';\nimport { USE_MOCK } from '../../CONFIG';\n\nconst API_GET_DRIVER =\n  '/ehuodiGateway/utmsDispatch/utmsDrivercs/selectDriverListByCondition';\n\nif (process.env.NODE_ENV === 'development') {\n  // 只在开发环境有效\n  // 生产环境通过 tree shaking 可以消除这段代码\n  // mocker\n  //   .on('post', API_GET_DRIVER)\n  //   .reply(() =>\n  //     import('./mock').then(exports => [200, exports.default]),\n  //   );\n}\n\nconst fetchDriver = (keyword, options) => {\n  return request(\n    {\n      method: 'post',\n      url: API_GET_DRIVER,\n      data: qs.stringify({\n        ...options,\n        searchInfo: keyword,\n        pageSize: 20,\n        skipCount: 0,\n      }),\n    },\n    {\n      useMock: USE_MOCK,\n    },\n  ).then(res => res.data);\n};\n\nexport default fetchDriver;\n","/**\n * DriverPicker Component\n * @author ryan bian\n * @date 2018-9-17 16:32:18\n */\nimport Select from 'antd/es/select';\nimport Spin from 'antd/es/spin';\nimport { debounce } from 'lodash';\nimport * as React from 'react';\nimport fetchDriver from './service';\n\nconst { Option } = Select;\n\nexport interface IDriverPickerProps {\n  placeholder?: string;\n  notFoundContent?: string;\n  bindingStatus?: 0 | 1 | null | undefined; // 绑定状态。绑定：1、未绑定：0。不传查询全部\n  renderOption?: (item: any) => JSX.Element;\n}\ninterface IDriverPickerState {\n  data: object[];\n  pending: boolean;\n}\n\nexport default class DriverPicker extends React.PureComponent<\n  IDriverPickerProps,\n  IDriverPickerState\n> {\n  static defaultProps = {\n    placeholder: '请选择司机',\n    notFoundContent: '没有找到匹配的司机',\n    bindingStatus: null,\n  };\n  static renderOption(item) {\n    return (\n      <Option key={item.utmsUsersDriversId} value={item.utmsUsersDriversId}>\n        {item.driverName}-{item.plateNumber}\n      </Option>\n    );\n  }\n  state = {\n    data: [],\n    pending: false,\n  };\n  lastFetchId = 0;\n  public fetch = debounce(keyword => {\n    const { bindingStatus } = this.props;\n    const fetchOptions = {};\n    if (typeof bindingStatus === 'number') {\n      Object.assign(fetchOptions, {\n        bindingStatus,\n      });\n    }\n    this.lastFetchId += 1;\n    const fetchId = this.lastFetchId;\n    this.setState({\n      data: [],\n      pending: true,\n    });\n    fetchDriver(keyword, fetchOptions)\n      .then(data => {\n        if (fetchId !== this.lastFetchId) {\n          // for fetch callback order\n          return;\n        }\n        this.setState({\n          data,\n          pending: false,\n        });\n      })\n      .catch(() => {\n        this.setState({\n          pending: false,\n        });\n      });\n  }, 500);\n  public render() {\n    const {\n      placeholder,\n      notFoundContent,\n      renderOption,\n      ...otherProps\n    } = this.props;\n    const { data, pending } = this.state;\n    const props = {\n      // className: styles.DriverPicker,\n      placeholder,\n      showSearch: true,\n      onSearch: this.fetch,\n      notFoundContent: pending ? <Spin /> : notFoundContent,\n      filterOption: false,\n    };\n    return (\n      <Select {...otherProps} {...props}>\n        {data.map(renderOption || DriverPicker.renderOption)}\n      </Select>\n    );\n  }\n}\n","/**\n * WeeklyEditor Component\n * @author ryan bian\n * @date 2018-9-17 09:04:56\n */\nimport Icon from 'antd/es/icon';\nimport { fromJS, List, Map } from 'immutable';\nimport _ from 'lodash';\nimport * as React from 'react';\nimport styles from './index.module.less';\n\nexport interface IWeeklyEditorProps {\n  data: List<Map<string, string | number>>;\n  onDelete: (scheduleData) => void;\n}\n\nexport const WEEKDAYS = [\n  { weekDay: 1, displayName: '周一' },\n  { weekDay: 2, displayName: '周二' },\n  { weekDay: 3, displayName: '周三' },\n  { weekDay: 4, displayName: '周四' },\n  { weekDay: 5, displayName: '周五' },\n  { weekDay: 6, displayName: '周六' },\n  { weekDay: 7, displayName: '周日' },\n];\n\nexport default class WeeklyEditor extends React.PureComponent<\n  IWeeklyEditorProps\n> {\n  public handleDeleteCard = e => {\n    const { driverId, useCarTime, weekday, uuid } = e.currentTarget.dataset;\n    this.props.onDelete({\n      driverId,\n      usecartime: useCarTime,\n      weekDay: weekday,\n      uuid,\n    });\n  };\n  public renderScheduleCard = detail => {\n    const uuid = detail.get('id') ? detail.get('id') : detail.get('uuid');\n    return (\n      <div className={styles.WeeklyEditor__Card} key={uuid}>\n        <Icon\n          data-weekday={detail.get('weekDay') || detail.get('weekday')}\n          data-use-car-time={detail.get('usecartime')}\n          data-driver-id={detail.get('driverId')}\n          data-uuid={uuid}\n          className={styles.WeeklyEditor__CardClose}\n          type=\"close\"\n          onClick={this.handleDeleteCard}\n        />\n        <p>{detail.get('usecartime')}</p>\n        <p>{detail.get('driverName')}</p>\n        <p>{detail.get('plateNumber')}</p>\n      </div>\n    );\n  };\n  public renderDayColumn = day => {\n    const { data } = this.props;\n\n    return (\n      <div className={styles.WeeklyEditor__DayColumn} key={day.weekDay}>\n        <h5 className={styles.WeeklyEditor__DayTitle}>{day.displayName}</h5>\n        {data\n          .filter(d => Number(d.get('weekDay')) === day.weekDay)\n          .sortBy(d => d.get('usecartime'))\n          .map(this.renderScheduleCard)\n          .toArray()}\n      </div>\n    );\n  };\n  public render() {\n    return (\n      <div className={styles.WeeklyEditor}>\n        {WEEKDAYS.map(this.renderDayColumn)}\n      </div>\n    );\n  }\n}\n","/**\n * CreateScheduleModal Component\n * @author ryan bian\n * @date 2018-9-17 09:04:56\n */\nimport Form from 'antd/es/form';\nimport { WrappedFormUtils } from 'antd/es/form/Form';\nimport Modal from 'antd/es/modal';\nimport Select from 'antd/es/select';\nimport TimePicker from 'antd/es/time-picker';\nimport DriverPicker from 'components/DriverPicker';\nimport * as React from 'react';\nimport { WEEKDAYS } from './WeeklyEditor';\n\nimport styles from './index.module.less';\n\nconst Option = Select.Option;\nconst FormItem = Form.Item;\nconst itemLayout = {\n  labelCol: { span: 6 },\n  wrapperCol: { span: 16 },\n};\n\nconst WeekdaySelectOptions = WEEKDAYS.map(day => (\n  <Option key={day.weekDay} value={day.weekDay}>\n    {day.displayName}\n  </Option>\n));\n\nexport interface ICreateScheduleModalProps {\n  form?: WrappedFormUtils;\n  onClose: () => void;\n  onConfirm: (values) => void;\n  visible: boolean;\n}\n\n@Form.create()\nexport default class CreateScheduleModal extends React.PureComponent<\n  ICreateScheduleModalProps\n> {\n  public componentWillReceiveProps(nextProps) {\n    if (nextProps.visible && !this.props.visible) {\n      nextProps.form.resetFields();\n    }\n  }\n  public handleSubmit = () => {\n    const { form, onConfirm } = this.props;\n    form.validateFields((errors, values) => {\n      if (!errors) {\n        onConfirm(values);\n      }\n    });\n  };\n  public handleClose = () => {\n    this.props.onClose();\n  };\n\n  public renderEditor() {\n    const { form } = this.props;\n    const { getFieldDecorator, setFieldsValue } = form;\n    return (\n      <Form>\n        <FormItem {...itemLayout} label=\"选择周期\" required>\n          {getFieldDecorator('weekdays', {\n            rules: [{ required: true, message: '请选择周期' }],\n          })(\n            <Select mode=\"multiple\" showArrow={true}>\n              {WeekdaySelectOptions}\n            </Select>,\n          )}\n        </FormItem>\n        <FormItem {...itemLayout} label=\"用车时间\" required>\n          {getFieldDecorator('usecartime', {\n            rules: [{ required: true, message: '请选择用车时间' }],\n          })(<TimePicker format=\"HH:mm\" />)}\n        </FormItem>\n        <FormItem {...itemLayout} label=\"选择司机\">\n          {getFieldDecorator('driver')(\n            <DriverPicker\n              renderOption={item => {\n                const value = [\n                  item.utmsDriverId,\n                  item.driverName,\n                  item.plateNumber,\n                ].join('@');\n                return (\n                  <Option key={item.utmsDriverId} value={value}>\n                    {item.driverName}-{item.plateNumber}\n                  </Option>\n                );\n              }}\n            />,\n          )}\n        </FormItem>\n      </Form>\n    );\n  }\n  public render() {\n    const { visible } = this.props;\n    const modalProps = {\n      title: '添加班次',\n      visible,\n      maskClosable: false,\n      centered: true,\n      onOk: this.handleSubmit,\n      onCancel: this.handleClose,\n    };\n    return <Modal {...modalProps}>{this.renderEditor()}</Modal>;\n  }\n}\n","/**\n * FixpathSchedule Component\n * @author ryan bian\n * @date 2018-9-17 09:04:56\n */\nimport Button from 'antd/es/button';\nimport Card from 'antd/es/card';\nimport Col from 'antd/es/col';\nimport DatePicker from 'antd/es/date-picker';\nimport Form from 'antd/es/form';\nimport { WrappedFormUtils } from 'antd/es/form/Form';\nimport Modal from 'antd/es/modal';\nimport Row from 'antd/es/row';\nimport Spin from 'antd/es/spin';\nimport { PageBottom } from 'components/PageBottom';\nimport { List, Map } from 'immutable';\nimport moment from 'moment';\nimport msngr from 'msngr';\nimport * as React from 'react';\nimport { createStructuredSelector } from 'reselect';\nimport CreateScheduleModal from './CreateScheduleModal';\nimport {\n  makeSelectData,\n  makeSelectDetail,\n  makeSelectError,\n  makeSelectLoading,\n} from './selectors';\nimport WeeklyEditor from './WeeklyEditor';\n\nimport styles from './index.module.less';\n\nconst FormItem = Form.Item;\nconst { RangePicker } = DatePicker;\nconst confirm = Modal.confirm;\n\nexport interface IFixpathScheduleProps {\n  children: React.ReactChildren;\n  form: WrappedFormUtils;\n  scheduleData: Map<string, any>;\n  detail: Map<string, any>;\n  searchParams: {\n    routeId: number;\n  };\n  loading: boolean;\n  getSchedule: (routeId: number) => any;\n  createSchedule: (createSchedule) => void;\n  deleteSchedule: (scheduleData) => void;\n  saveScheduleConfig: (dateRange, handleClose) => void;\n  getDetail: (routeId: number) => any;\n  close: () => void;\n  toList: () => void;\n}\n\ninterface IFixpathScheduleState {\n  openModal: boolean;\n}\n\n@Form.create()\nclass FixpathSchedule extends React.PureComponent<\n  IFixpathScheduleProps,\n  IFixpathScheduleState\n> {\n  state = {\n    openModal: false,\n  };\n  public componentDidMount() {\n    const { close, searchParams } = this.props;\n    if (!searchParams.routeId) {\n      Modal.error({\n        title: '参数异常',\n        content: '缺少线路ID，页面将关闭',\n        onOk() {\n          close();\n        },\n      });\n    } else {\n      this.props.getSchedule(searchParams.routeId);\n      this.props.getDetail(searchParams.routeId);\n    }\n  }\n  public componentWillReceiveProps(nextProps) {\n    if (\n      nextProps.scheduleData &&\n      nextProps.scheduleData !== this.props.scheduleData\n    ) {\n      this.setRangeDate(nextProps);\n    }\n  }\n  // 取消编辑\n  public handleClose = () => {\n    confirm({\n      title: '有未保存的信息',\n      content: '如放弃，填写的信息将丢失',\n      okText: '继续填写',\n      cancelText: '放弃',\n      onCancel: () => {\n        this.props.toList();\n        this.props.close();\n        msngr('/fixpath/list', 'refresh').emit(true);\n      },\n    });\n  };\n  public handleOpenModal = () => {\n    this.setState({\n      openModal: true,\n    });\n  };\n  public handleCloseModal = () => {\n    this.setState({\n      openModal: false,\n    });\n  };\n  public handleCreateSchedule = values => {\n    this.props.createSchedule(values);\n    this.setState({\n      openModal: false,\n    });\n  };\n  public handleSubmitSchedule = () => {\n    const { form, saveScheduleConfig } = this.props;\n    form.validateFields((errors, values) => {\n      if (!errors) {\n        saveScheduleConfig(values.dateRange, this.props.close);\n      }\n    });\n  };\n  public renderInfo() {\n    const { form, scheduleData, detail } = this.props;\n    const { getFieldDecorator, setFieldsValue } = form;\n\n    return (\n      <Form layout=\"inline\">\n        <Card title=\"运力计划\" className={styles.FixpathSchedule__InfoCard}>\n          <Row className={styles.FixpathSchedule__FormItem}>\n            <Col md={12} lg={8}>\n              <FormItem label=\"客户名称\">{detail.get('customerName')}</FormItem>\n            </Col>\n            <Col md={12} lg={8}>\n              <FormItem label=\"线路名称\">{detail.get('routeName')}</FormItem>\n            </Col>\n          </Row>\n        </Card>\n        <Card>\n          <Row className={styles.FixpathSchedule__FormItem}>\n            <Col md={24} lg={24}>\n              <FormItem required label=\"起止时间\">\n                {getFieldDecorator('dateRange', {\n                  rules: [{ required: true, message: '请选择起止时间' }],\n                })(<RangePicker />)}\n              </FormItem>\n            </Col>\n          </Row>\n          <Row>\n            <Col>\n              <Button\n                type=\"dashed\"\n                icon=\"plus\"\n                block\n                onClick={this.handleOpenModal}\n              >\n                添加班次\n              </Button>\n            </Col>\n          </Row>\n          {this.renderWeekEditor()}\n        </Card>\n      </Form>\n    );\n  }\n  public renderWeekEditor() {\n    const { scheduleData, deleteSchedule } = this.props;\n    return (\n      <WeeklyEditor\n        data={scheduleData.get('workScheduleDetailList', List())}\n        onDelete={deleteSchedule}\n      />\n    );\n  }\n  public renderBottom() {\n    const { scheduleData } = this.props;\n    const actions = [\n      <Button\n        key=\"cancle\"\n        className={styles.FixpathSchedule__BottomActionButton}\n        onClick={this.handleClose}\n      >\n        取消\n      </Button>,\n      <Button\n        key=\"save\"\n        type=\"primary\"\n        disabled={\n          scheduleData.get('workScheduleDetailList', List()).count() === 0\n        }\n        onClick={this.handleSubmitSchedule}\n      >\n        保存线路\n      </Button>,\n    ];\n    return <PageBottom rightChild={actions} />;\n  }\n  public render() {\n    return (\n      <React.Fragment>\n        <Spin spinning={this.props.loading}>\n          <div className={styles.FixpathSchedule}>\n            {this.renderInfo()}\n            {this.renderBottom()}\n          </div>\n        </Spin>\n        <CreateScheduleModal\n          visible={this.state.openModal}\n          onConfirm={this.handleCreateSchedule}\n          onClose={this.handleCloseModal}\n        />\n      </React.Fragment>\n    );\n  }\n\n  private setRangeDate(props) {\n    const { scheduleData, form } = props;\n    if (\n      scheduleData.size &&\n      scheduleData.get('startDate') &&\n      scheduleData.get('endDate') &&\n      !form.getFieldValue('dateRange')\n    ) {\n      form.setFieldsValue({\n        dateRange: [\n          moment(scheduleData.get('startDate'), 'YYYY-MM-DD'),\n          moment(scheduleData.get('endDate'), 'YYYY-MM-DD'),\n        ],\n      });\n    }\n  }\n}\n\nexport default ({ routeId, connectModel }) => {\n  return connectModel(actions => {\n    const currentState = state => state.get(routeId);\n    return {\n      mapStateToProps: createStructuredSelector({\n        detail: makeSelectDetail(currentState),\n        scheduleData: makeSelectData(currentState),\n        error: makeSelectError(currentState),\n        loading: makeSelectLoading(currentState),\n      }),\n      mapDispatchToProps: dispatch => ({\n        getSchedule: options => dispatch(actions.getSchedule(options)),\n        getDetail: options => dispatch(actions.getDetail(options)),\n        createSchedule: schedule => dispatch(actions.createSchedule(schedule)),\n        deleteSchedule: scehduleData =>\n          dispatch(actions.deleteSchedule(scehduleData)),\n        saveScheduleConfig: (dateRange, handleClose) =>\n          dispatch(actions.saveScheduleConfig(dateRange, handleClose)),\n        toList: options => dispatch(actions.toList(options)),\n      }),\n    };\n  })(FixpathSchedule);\n};\n","/**\n * FixpathSchedule selectors\n * @author ryan bian\n * @date 2018-9-17 09:04:56\n */\nimport { Map } from 'immutable';\nimport { createSelector } from 'reselect';\n\nexport const makeSelectError = selectState =>\n  createSelector(selectState, (state: Map<string, any>) => state.get('error'));\n\nexport const makeSelectLoading = selectState =>\n  createSelector(selectState, (state: Map<string, any>) =>\n    state.get('loading'),\n  );\n\nexport const makeSelectData = selectState =>\n  createSelector(selectState, (state: Map<string, any>) => state.get('data'));\n\nexport const makeSelectDetail = selectState =>\n  createSelector(selectState, (state: Map<string, any>) => state.get('detail'));\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"FixpathSchedule\":\"_1pHbi\",\"FixpathSchedule__BottomActionButton\":\"_3Yp3U\",\"FixpathSchedule__InfoCard\":\"ob21b\",\"FixpathSchedule__FormItem\":\"_ECHF\",\"WeeklyEditor\":\"_1cHxI\",\"WeeklyEditor__DayColumn\":\"UaX_P\",\"WeeklyEditor__DayTitle\":\"_1Ex1a\",\"WeeklyEditor__Card\":\"_1TzbP\",\"WeeklyEditor__CardClose\":\"rWE0m\"};"],"sourceRoot":""}